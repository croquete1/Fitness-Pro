import{f as h,k as G,o as L,j as e,g as x,h as P,i as H,r as T,n as W,p as B,S as M,x as F,d as D,y as R,e as p}from"./index-DJ8sexXN.js";import{B as g,H as k}from"./heading-iMxg-re2.js";import{T as l}from"./text-DsZGIkQi.js";import{S as q}from"./simple-grid-CuqY1g_w.js";import{c as I,B as N}from"./button-BLaV3_SP.js";const A=h(function(i,r){const{borderLeftWidth:d,borderBottomWidth:o,borderTopWidth:j,borderRightWidth:v,borderWidth:b,borderStyle:_,borderColor:f,...C}=G("Divider",i),{className:z,orientation:s="horizontal",__css:n,...t}=L(i),u={vertical:{borderLeftWidth:d||v||b||"1px",height:"100%"},horizontal:{borderBottomWidth:o||j||b||"1px",width:"100%"}};return e.jsx(x.hr,{ref:r,"aria-orientation":s,...t,__css:{...C,border:"0",borderColor:f,borderStyle:_,...u[s],...n},className:P("chakra-divider",z)})});A.displayName="Divider";const[J,y]=I({name:"TableStylesContext",errorMessage:`useTableStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Table />" `}),w=h((a,i)=>{const r=H("Table",a),{className:d,layout:o,...j}=L(a);return e.jsx(J,{value:r,children:e.jsx(x.table,{ref:i,__css:{tableLayout:o,...r.table},className:P("chakra-table",d),...j})})});w.displayName="Table";const U=h((a,i)=>{const r=y();return e.jsx(x.tbody,{...a,ref:i,__css:r.tbody})}),c=h(({isNumeric:a,...i},r)=>{const d=y();return e.jsx(x.td,{...i,ref:r,__css:d.td,"data-is-numeric":a})}),m=h(({isNumeric:a,...i},r)=>{const d=y();return e.jsx(x.th,{...i,ref:r,__css:d.th,"data-is-numeric":a})}),E=h((a,i)=>{const r=y();return e.jsx(x.thead,{...a,ref:i,__css:r.thead})}),S=h((a,i)=>{const r=y();return e.jsx(x.tr,{...a,ref:i,__css:r.tr})});function Y({user:a,profile:i}){const[r,d]=T.useState([]),[o,j]=T.useState([]),[v,b]=T.useState(!0);T.useEffect(()=>{_()},[]);async function _(){b(!0);const s=await W(B(p,"users")),n=await W(B(p,"treinos"));d(s.docs.map(t=>({id:t.id,...t.data()}))),j(n.docs.map(t=>({id:t.id,...t.data()}))),b(!1)}const f=async(s,n)=>{await F(D(p,"users",s),{role:n}),d(t=>t.map(u=>u.id===s?{...u,role:n}:u))},C=async s=>{await R(D(p,"users",s)),d(n=>n.filter(t=>t.id!==s))},z=async s=>{await R(D(p,"treinos",s)),j(n=>n.filter(t=>t.id!==s))};return v?e.jsxs(g,{className:"admin-spinner",children:[e.jsx(M,{size:"xl"}),e.jsx(l,{mt:4,children:"Carregando dados do sistemaâ€¦"})]}):e.jsxs(g,{className:"admin-container",p:8,children:[e.jsx(k,{className:"admin-title",mb:6,children:"ðŸ›  Painel de AdministraÃ§Ã£o"}),e.jsxs(q,{columns:2,spacing:4,mb:8,children:[e.jsxs(g,{className:"admin-card",children:[e.jsx(l,{className:"admin-card-title",children:"Utilizadores"}),e.jsxs(l,{children:["Clientes: ",r.filter(s=>s.role==="cliente").length]}),e.jsxs(l,{children:["Trainers: ",r.filter(s=>s.role==="trainer").length]}),e.jsxs(l,{children:["Admins: ",r.filter(s=>s.role==="admin").length]})]}),e.jsxs(g,{className:"admin-card",children:[e.jsx(l,{className:"admin-card-title",children:"Atividades"}),e.jsxs(l,{children:["Total de treinos: ",o.length]}),e.jsxs(l,{children:["Ãšltimo treino:"," ",o.sort((s,n)=>n.data.localeCompare(s.data))[0]?.data||"â€”"]})]})]}),e.jsx(A,{className:"admin-divider",mb:6}),e.jsx(k,{size:"md",mb:4,children:"ðŸ‘¤ GestÃ£o de Utilizadores"}),e.jsxs(w,{variant:"striped",className:"admin-table",mb:8,children:[e.jsx(E,{children:e.jsxs(S,{children:[e.jsx(m,{children:"Email"}),e.jsx(m,{children:"Role"}),e.jsx(m,{children:"AÃ§Ãµes"})]})}),e.jsx(U,{children:r.map(s=>e.jsxs(S,{children:[e.jsx(c,{children:s.email}),e.jsx(c,{children:s.role}),e.jsxs(c,{children:[s.role!=="admin"&&e.jsxs(e.Fragment,{children:[e.jsx(N,{size:"sm",mr:2,onClick:()=>f(s.id,"trainer"),children:"Trainer"}),e.jsx(N,{size:"sm",mr:2,onClick:()=>f(s.id,"cliente"),children:"Cliente"})]}),e.jsx(N,{size:"sm",colorScheme:"red",onClick:()=>C(s.id),children:"Remover"})]})]},s.id))})]}),e.jsx(A,{className:"admin-divider",my:6}),e.jsx(k,{size:"md",mb:4,children:"ðŸ“‚ Auditoria de Treinos"}),e.jsxs(w,{variant:"simple",className:"admin-table",children:[e.jsx(E,{children:e.jsxs(S,{children:[e.jsx(m,{children:"Nome"}),e.jsx(m,{children:"Cliente"}),e.jsx(m,{children:"Data"}),e.jsx(m,{children:"AÃ§Ãµes"})]})}),e.jsx(U,{children:o.map(s=>e.jsxs(S,{children:[e.jsx(c,{children:s.nome}),e.jsx(c,{children:s.clienteId}),e.jsx(c,{children:s.data}),e.jsx(c,{children:e.jsx(N,{size:"sm",colorScheme:"red",onClick:()=>z(s.id),children:"Apagar"})})]},s.id))})]})]})}export{Y as default};
